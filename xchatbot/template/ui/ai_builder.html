{% extends "base.html" %}
{% load static %}
{% block title %}AI Builder - Create Your Intelligent Assistant{% endblock %}

{% block content %}
    <style>
        :root {
            --background: #ffffff;
            --surface: #f8fafc;
            --surface-hover: #f1f5f9;
            --surface-light: #e2e8f0;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --primary-light: #93c5fd;
            --secondary: #10b981;
            --secondary-hover: #059669;
            --text: #1f2937;
            --text-secondary: #4b5563;
            --text-muted: #6b7280;
            --border: #e5e7eb;
            --border-light: #d1d5db;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --accent: #8b5cf6;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 12px 28px rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            margin-bottom: 40px;
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, var(--surface) 0%, var(--surface-light) 100%);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 12px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--text-muted);
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            background: var(--surface);
            border-radius: 12px;
            padding: 6px;
            border: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 20px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border-radius: 8px;
        }

        .tab.active {
            color: var(--text);
            background: var(--background);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .tab:hover:not(.active) {
            background: var(--surface-hover);
            color: var(--text);
            transform: translateY(-1px);
        }

        .tab-icon {
            font-size: 1.1rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .main-content {
            display: flex;
            gap: 32px;
        }

        .content-area {
            flex: 1;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 32px;
            min-height: 500px;
        }

        .content-header {
            margin-bottom: 24px;
        }

        .content-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
        }

        .content-description {
            color: var(--text-muted);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.95rem;
            background: var(--background);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .text-editor {
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--background);
            overflow: hidden;
        }

        .editor-toolbar {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border-bottom: 1px solid var(--border);
            background: var(--surface);
        }

        .editor-btn {
            padding: 6px 8px;
            border: none;
            background: none;
            border-radius: 4px;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.9rem;
            transition: all 0.2s;
            min-width: 28px;
            text-align: center;
        }

        .editor-btn:hover {
            background: var(--surface-hover);
            color: var(--text);
        }

        .editor-btn.active {
            background: var(--primary);
            color: white;
        }

        .editor-textarea {
            width: 100%;
            min-height: 300px;
            padding: 16px;
            border: none;
            outline: none;
            resize: vertical;
            font-family: inherit;
            font-size: 0.95rem;
            color: var(--text);
            background: var(--background);
            line-height: 1.5;
        }

        .editor-textarea::placeholder {
            color: var(--text-muted);
        }

        .sidebar-panel {
            width: 280px;
            flex-shrink: 0;
            background: var(--surface);
            border-radius: 8px;
            padding: 24px;
            height: fit-content;
        }

        .sidebar-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
        }

        .size-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .create-btn {
            width: 100%;
            padding: 12px 24px;
            background: var(--text);
            color: var(--background);
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
        }

        .create-btn:hover {
            background: var(--text-secondary);
        }

        .add-snippet-btn {
            background: var(--text-secondary);
            color: var(--background);
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 16px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .add-snippet-btn:hover {
            background: var(--text);
        }

        .empty-state {
            text-align: center;
            padding: 80px 40px;
            color: var(--text-muted);
        }

        .empty-state h3 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--text);
        }

        .empty-state p {
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .byte-counter {
            margin-left: auto;
            color: var(--text-muted);
            font-size: 0.8rem;
        }
    </style>

    <div id="mainContent" class="main-content">
        <div class="container">
            <div class="header">
                <h1>Create AI Agent</h1>
                <p>Build your intelligent assistant with custom knowledge and capabilities. Configure training data, upload files, and customize your agent's behavior.</p>
            </div>

            <!-- Add this in <head> if not using build tools -->
<script src="https://unpkg.com/lucide@latest"></script>

<div class="tabs">
    <button class="tab active" onclick="showTab('configuration')">
        <span class="tab-icon" data-lucide="check-circle"></span>
        Core
    </button>
    <button class="tab" onclick="showTab('files')">
        <span class="tab-icon" data-lucide="folder"></span>
        Files
    </button>
    <button class="tab" onclick="showTab('websites')">
        <span class="tab-icon" data-lucide="globe"></span>
        Websites
    </button>
    <button class="tab" onclick="showTab('theme')">
        <span class="tab-icon" data-lucide="palette"></span>
        Theme
    </button>
    <button class="tab" onclick="showTab('confirm')">
       <span class="tab-icon" data-lucide="upload-cloud"></span>
        Deploy
    </button>
</div>

<script>
    lucide.createIcons(); // Load icons
</script>


            <div id="configuration" class="tab-content active">
                <div class="main-content" >
                    <div class="content-area">
                        <div class="content-header">
                            <h2 class="content-title">Configuration</h2>
                            <p class="content-description">Add your agent name and description ( what you want it to do and nature etc ) . In Text you can add knowledge base etc which will help to answer .</p>
                        </div>

                        <form method="post" id="botForm" action="{% url 'xbot:create_bot' %}">
                                {% csrf_token %}

                                <div class="form-group">
                                    <label for="title" class="form-label">Agent Name</label>
                                    <input 
                                    type="text" 
                                    id="title" 
                                    name="title" 
                                    class="form-input" 
                                    placeholder="Eve , Milly , Emily"
                                    required
                                    >
                                </div>

                                <div class="form-group">
                                    <label for="description" class="form-label">Description</label>
                                    <input 
                                    type="text" 
                                    id="description" 
                                    name="description" 
                                    class="form-input" 
                                    placeholder="You are Eve an sales agent of vertlix helps .....  "
                                    required
                                    >
                                </div>

                                <div class="form-group">
                                    <label for="text" class="form-label">Knowledge</label>
                                    <div class="text-editor">
                                    <div class="editor-toolbar">
                                         <button type="button" class="editor-btn" onclick="insertQuote()">‚ùù </button>
                                          <button type="button" class="editor-btn" onclick="insertCodeBlock()">‚å®</button>
                                        <button type="button" class="editor-btn" onclick="insertList('ul')">B</button>
                                        <button type="button" class="editor-btn" onclick="insertList('ol')">1.</button>
                                        <button type="button" class="editor-btn" onclick="insertLink()">üîó</button>
                                        <div class="byte-counter" id="byteCounter">0 B</div>
                                    </div>
                                    <textarea 
                                        id="text" 
                                        name="text" 
                                        class="editor-textarea" 
                                        placeholder="Enter your text"
                                        oninput="updateByteCounter()"
                                        required
                                    ></textarea>
                                    </div>
                                    <script>
function insertQuote() {
    const textarea = document.getElementById("text");
    const lines = textarea.value.split("\n");
    const start = textarea.selectionStart;
    let charCount = 0;

    for (let i = 0; i < lines.length; i++) {
        const lineLength = lines[i].length + 1; // +1 for newline
        if (start <= charCount + lineLength) {
            lines[i] = "> " + lines[i];
            break;
        }
        charCount += lineLength;
    }

    textarea.value = lines.join("\n");
    updateByteCounter();
}

function insertCodeBlock() {
    const textarea = document.getElementById("text");
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selectedText = textarea.value.substring(start, end);
    const before = textarea.value.substring(0, start);
    const after = textarea.value.substring(end);
    const newText = before + "\n```\n" + selectedText + "\n```\n" + after;
    textarea.value = newText;
    textarea.selectionStart = start + 4;
    textarea.selectionEnd = end + 4;
    updateByteCounter();
}

function updateByteCounter() {
    const text = document.getElementById("text").value;
    const bytes = new Blob([text]).size;
    document.getElementById("byteCounter").textContent = `${bytes} B`;
}
</script>

                                </div>

                                <button type="submit" style="background-color:black; min-width: 150px" onclick="switchTab('settings')" class="add-snippet-btn">Create</button>
                                </form >

                    </div>

                   <div class="relative sidebar-panel overflow-hidden rounded-lg shadow border border-gray-200 bg-white" style="pointer-events: none !important;">
                        <div class="absolute inset-0 bg-white/60 backdrop-blur-sm z-10" style="pointer-events: none !important;"></div>
                        <div class="opacity-30 select-none p-4 space-y-4 blur-[0.5px]" style="pointer-events: none !important;">
                          <div class="sidebar-title text-lg font-semibold">Deploy & Launch</div>
                          <div class="size-info text-sm text-gray-600" style="display: block;">
                            <li>Pleasae Click on Create to Create the Bot</li>  
                            <li>You can fill the next options or go to deploy tab to launch the agent </li>
                          </div>
                        <button type="button" class="create-btn bg-gray-400 text-white py-2 px-4 rounded" disabled style="pointer-events: none !important; cursor: default !important;">
                        üîí Locked
                      </button>

                        </div>
                      </div>
                </div>
            </div>

            <div id="files" class="tab-content">
                <div class="main-content">
                    <div class="content-area">
                        <div id="uploadSection" style="padding: 24px; max-width: 700px; margin: 40px auto; background: #fff; border-radius: 10px; border: 1px solid #e0e0e0; font-family: Arial, sans-serif;">
                        <h2 style="margin-top: 0; margin-bottom: 8px; font-size: 24px; color: #1a1a1a;">Files</h2>
                        <p style="margin: 0 0 24px; font-size: 14px; color: #555;">
                            The Files tab allows you to upload and manage various document types to train your AI agent. 
                            <a href="#" style="color: #4a90e2; text-decoration: none;">Learn more</a>
                        </p>
<form id="uploadForm" method="POST" enctype="multipart/form-data" action="{% url 'xbot:upload_file' %}">
  {% csrf_token %}
  <label id="dropBox" for="fileUpload" style="display: block; border: 1px dashed #ccc; padding: 40px 20px; text-align: center; border-radius: 8px; background-color: #fafafa; cursor: pointer; transition: all 0.2s;">
    <div style="font-size: 30px; color: #aaa; margin-bottom: 8px;">‚¨ÜÔ∏è</div>
    <div style="font-size: 15px; color: #333; font-weight: 500;">Drag & drop files here, or click to select files</div>
    <div style="font-size: 13px; color: #777; margin-top: 4px;">Supported File Types: .pdf, .doc, .docx, .txt</div>
    <input type="file" id="fileUpload" name="file" required style="display: none;" />
  </label>

  <div id="loadingMessage" style="text-align: center; color: #333; font-size: 14px; margin-top: 12px; display: none;">
    ‚è≥ Extracting data, please wait...
  </div>

  <div style="text-align:center; margin-top: 10px;">
    <button id="analyzeBtn" type="button" style="background:black;color:white;padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-size:16px;">
      Analyze Data
    </button>
  </div>
</form>
<div id="toastMessage" style="
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #323232;
  color: #fff;
  padding: 12px 20px;
  border-radius: 8px;
  font-size: 14px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  display: none;
  z-index: 9999;
  transition: opacity 0.3s ease;
"></div>


<script>
  function showToast(message, duration = 3000) {
    const toast = document.getElementById("toastMessage");
    toast.textContent = message;
    toast.style.display = "block";
    toast.style.opacity = 1;

    setTimeout(() => {
      toast.style.opacity = 0;
      setTimeout(() => {
        toast.style.display = "none";
      }, 300);
    }, duration);
  }

  const fileInput = document.getElementById("fileUpload");
  const analyzeBtn = document.getElementById("analyzeBtn");

  analyzeBtn.addEventListener("click", function (e) {
    e.preventDefault();

    const file = fileInput.files[0];
    const botId = localStorage.getItem("last_created_bot_id");

    if (!file || !botId) {
      showToast("‚ùå Missing file or Bot ID.");
      return;
    }

    const formData = new FormData();
    formData.append("file", file);
    formData.append("bot_id", botId);

    showToast("‚è≥ Extracting data...");

    analyzeBtn.innerText = "‚è≥ Extracting...";
    analyzeBtn.disabled = true;

    fetch("{% url 'xbot:upload_file' %}", {
      method: "POST",
      body: formData,
    })
      .then((res) => res.json())
      .then((data) => {
        analyzeBtn.innerText = "Analyze Data";
        analyzeBtn.disabled = false;

        if (data.success) {
          showToast("‚úÖ Data extracted and saved!");
        } else {
          showToast("‚ùå " + data.error);
        }
      })
      .catch((err) => {
        console.error("Upload error:", err);
        showToast("‚ùå Something went wrong during upload.");
        analyzeBtn.innerText = "Analyze Data";
        analyzeBtn.disabled = false;
      });
  });
</script>





                        <p style="margin-top: 20px; font-size: 13px; color: #666; text-align: center;">
                            If you are uploading a PDF, make sure you can select/highlight the text.
                        </p>
                        </div>



                    </div>
                     <div class="relative sidebar-panel overflow-hidden rounded-lg shadow border border-gray-200 bg-white" style="pointer-events: none !important;">
                        <div class="absolute inset-0 bg-white/60 backdrop-blur-sm z-10" style="pointer-events: none !important;"></div>
                        <div class="opacity-30 select-none p-4 space-y-4 blur-[0.5px]" style="pointer-events: none !important;">
                          <div class="sidebar-title text-lg font-semibold">Deploy & Launch</div>
                          <div class="size-info text-sm text-gray-600" style="display: block;">
                            <li>Pleasae Click Analyze data </li>  
                            <li>You can fill the next options or go to deploy tab to launch the agent </li>
                          </div>
                        <button type="button" class="create-btn bg-gray-400 text-white py-2 px-4 rounded" disabled style="pointer-events: none !important; cursor: default !important;">
                        üîí Locked
                      </button>

                        </div>
                      </div>
                </div>
            </div>

            <div id="websites" class="tab-content">
                <div class="main-content">
                    <div class="content-area">
                        <div style="max-width: 720px; margin: 40px auto; padding: 32px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fff; font-family: 'Segoe UI', sans-serif;">
                        <h2 style="margin-top: 0; font-size: 20px; font-weight: 600; color: #1a1a1a;">Link</h2>
                        <p style="font-size: 14px; color: #555; margin-bottom: 24px;">
                            Crawl specific web pages to continuously update your AI with the latest content.
                            <a href="#" style="color: #3b82f6; text-decoration: none;">Learn more</a>
                        </p>

                        <!-- Tabs -->
                        <div style="display: flex; border-bottom: 1px solid #ddd; margin-bottom: 20px;">
                            <div id="crawlTab" onclick="switchTab('crawl')" style="padding: 10px 16px; font-weight: 500; color: #1a1a1a; border-bottom: 2px solid #1a1a1a; cursor: pointer;">Crawl links</div>
                            <div id="settingsTab" onclick="switchTab('settings')" style="padding: 10px 16px; color: #666; cursor: pointer;">Settings</div>
                        </div>

                        <!-- Crawl Content -->
                         <form id="urlForm">
  <div id="crawlContent">
    <label style="display: block; font-size: 14px; color: #333; margin-bottom: 8px;">URL</label>
    <div style="display: flex; align-items: center; border: 1px solid #ccc; border-radius: 8px; overflow: hidden; margin-bottom: 12px;">
      <span style="background: #f1f1f1; padding: 12px 14px; font-size: 14px; color: #666;">https://</span>
      <input type="text" id="urlInput" placeholder="www.example.com" style="flex: 1; padding: 12px 14px; border: none; font-size: 14px; outline: none;" />
    </div>

    <button type="submit" id="trainBtn" style="padding: 12px 24px; font-size: 14px; background-color: #444; color: #fff; border: none; border-radius: 8px; cursor: pointer;">
      Train
    </button>

    <p id="urlError" style="margin-top: 14px; color: #e53935; font-size: 13px; display: none;">‚ùå Please enter a valid website URL.</p>
  </div>
</form>

<!-- Toast Message Container -->
<!-- Center Popup Notification -->
<div id="centerPopup" style="
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #ffffff;
  color: #374151;
  padding: 32px 40px;
  border-radius: 12px;
  font-size: 15px;
  font-weight: 500;
  z-index: 9999;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 8px 16px rgba(0, 0, 0, 0.06);
  border: 1px solid #e5e7eb;
  max-width: 90%;
  width: 420px;
  text-align: center;
  opacity: 0;
  transition: all 0.3s ease;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height: 1.5;
">
  <div id="popupContent" style="
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    min-height: 24px;
  ">
    <div id="popupLoader" style="
      display: none;
      width: 20px;
      height: 20px;
      border: 2px solid #e5e7eb;
      border-top: 2px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    "></div>
    <span id="popupMessage"></span>
  </div>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>

<script>
function showPopupMessage(message, duration = 4000) {
  const popup = document.getElementById("centerPopup");
  const content = document.getElementById("popupMessage");
  const loader = document.getElementById("popupLoader");
  
  content.innerHTML = message;
  
  // Show loader for loading messages
  if (message.includes("‚è≥") || message.includes("Training your model") || message.includes("please wait")) {
    loader.style.display = "block";
  } else {
    loader.style.display = "none";
  }

  popup.style.display = "block";
  popup.style.opacity = "1";
  popup.style.transform = "translate(-50%, -50%) scale(1)";

  setTimeout(() => {
    popup.style.opacity = "0";
    popup.style.transform = "translate(-50%, -50%) scale(0.97)";
    setTimeout(() => {
      popup.style.display = "none";
      loader.style.display = "none";
    }, 300);
  }, duration);
}

document.getElementById("urlForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const urlInput = document.getElementById("urlInput").value.trim();
  const botId = localStorage.getItem("last_created_bot_id");

  if (!urlInput || !botId) {
    showPopupMessage("‚ùå Missing URL or Bot ID");
    return;
  }

  const fullUrl = urlInput.startsWith("http") ? urlInput : `https://${urlInput}`;
  showPopupMessage("‚è≥ Training your model, please wait...");

  fetch("{% url 'xbot:train_from_url' %}", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-CSRFToken": document.querySelector('[name=csrfmiddlewaretoken]').value
    },
    body: JSON.stringify({
      bot_id: botId,
      url: fullUrl
    })
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      showPopupMessage("‚úÖ Training complete. You may proceed.");
    } else {
      showPopupMessage("‚ùå " + (data.error || "An error occurred"));
    }
  })
  .catch(err => {
    console.error(err);
    showPopupMessage("‚ùå Something went wrong.");
  });
});
</script>



                        <!-- Settings Content -->
                        <div id="settingsContent" style="display: none; margin-top: 10px;">
                            <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px; color: #1a1a1a;">Crawling Settings</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 12px;">
                            <div class="option-btn" onclick="toggleOption(this)">Extract Emails</div>
                            <div class="option-btn" onclick="toggleOption(this)">Extract Contact Numbers</div>
                            <div class="option-btn" onclick="toggleOption(this)">Crawl All Pages</div>
                            <div class="option-btn" onclick="toggleOption(this)">Internet Surfing for Product Info</div>
                            <div class="option-btn" onclick="toggleOption(this)">None (Basic Crawl)</div>
                            </div>
                        </div>
                        </div>



                    </div>
                    <div class="relative sidebar-panel overflow-hidden rounded-lg shadow border border-gray-200 bg-white" style="pointer-events: none !important;">
                        <div class="absolute inset-0 bg-white/60 backdrop-blur-sm z-10" style="pointer-events: none !important;"></div>
                        <div class="opacity-30 select-none p-4 space-y-4 blur-[0.5px]" style="pointer-events: none !important;">
                          <div class="sidebar-title text-lg font-semibold">Deploy & Launch</div>
                          <div class="size-info text-sm text-gray-600" style="display: block;">
                            <li>Pleasae Train after inserting correct URL </li>  
                            <li>You can fill the next options or go to deploy tab to launch the agent </li>
                          </div>
                        <button type="button" class="create-btn bg-gray-400 text-white py-2 px-4 rounded" disabled style="pointer-events: none !important; cursor: default !important;">
                        üîí Locked
                      </button>

                        </div>
                      </div>
                </div>
            </div>

            <div id="theme" class="tab-content">
                <div class="main-content">
                    <div class="content-area">
                        <div style="background-color: #fff; border: 1px solid #ddd; border-radius: 16px; padding: 32px; max-width: 700px; margin: 50px auto; box-shadow: 0 8px 24px rgba(0,0,0,0.06); font-family: 'Segoe UI', sans-serif; text-align: center;">

  <!-- Heading -->
  <h2 style="font-size: 24px; color: #222; margin-bottom: 12px;">Select Theme</h2>

  <!-- Paragraph -->
  <p style="font-size: 15px; color: #555; margin-bottom: 24px;">
    Make your chatbot interface feel like your own by selecting a theme that fits your style.
  </p>

  <!-- Image Container with Overlay Label -->
  <div style="position: relative; display: inline-block; margin-bottom: 24px;">
    <!-- Label on top of image -->
    <div style="position: absolute; top: 10px; left: 10px; background-color: rgba(0,0,0,0.6); color: #fff; padding: 6px 12px; border-radius: 6px; font-size: 14px;">
      NVB Theme
    </div>
    <!-- Image -->
    <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg"
         alt="Theme Preview"
         style="width: 100%; max-width: 500px; border-radius: 12px;" />
  </div>

  <!-- Button -->
  <div style="margin-bottom: 24px;">
    <button onclick="openThemePopup()" style="padding: 12px 24px; font-size: 15px; background-color: #2c7be5; color: #fff; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 4px 12px rgba(44,123,229,0.2);">
      Choose Theme
    </button>
  </div>

  <!-- Instruction -->
  <p style="font-size: 14px; color: #888; line-height: 1.6;">
    You can choose available themes based on your plan.<br />
    <strong>Free Plan:</strong> Default theme only.<br />
    <strong>Premium Plan:</strong> Unlock all advanced theme options.
  </p>

</div>

                    </div>
                    <div class="relative sidebar-panel overflow-hidden rounded-lg shadow border border-gray-200 bg-white" style="pointer-events: none !important;">
                        <div class="absolute inset-0 bg-white/60 backdrop-blur-sm z-10" style="pointer-events: none !important;"></div>
                        <div class="opacity-30 select-none p-4 space-y-4 blur-[0.5px]" style="pointer-events: none !important;">
                          <div class="sidebar-title text-lg font-semibold">Deploy & Launch</div>
                          <div class="size-info text-sm text-gray-600" style="display: block;">
                            <li>You can choose any of the theme you like for your chatbot from our given theme </li>  
                          </div>
                        <button type="button" class="create-btn bg-gray-400 text-white py-2 px-4 rounded" disabled style="pointer-events: none !important; cursor: default !important;">
                        üîí Locked
                      </button>

                        </div>
                      </div>
                </div>
            </div>

            <div id="confirm" class="tab-content">
                <div class="main-content">
                    <div class="content-area">
                        <div class="empty-state">
                            <div style="width: 100%; font-family: 'Segoe UI', sans-serif; box-sizing: border-box;">

  <div style="background-color: #fff; border: 1px solid #dcdcdc; border-radius: 12px; padding: 20px; max-width: 100%; box-shadow: 0 2px 6px rgba(0,0,0,0.04);">

    <!-- Heading -->
    <h3 style="font-size: 18px; font-weight: 600; color: #111; margin: 0 0 12px 0;">Review and Deploy</h3>

    <!-- Instruction -->
    <p style="font-size: 14px; color: #666; margin: 0 0 16px 0;">
      Please confirm each of the following steps before deploying your chatbot.
    </p>

    <!-- Checklist -->
    <div style="display: flex; flex-direction: column; gap: 10px;">
      
  <label style="display: flex; align-items: center; background: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 10px 12px; cursor: pointer; margin-bottom: 10px;">
  <input type="checkbox" style="margin-right: 10px; width: 16px; height: 16px; accent-color: #2c7be5;" />
  <span style="font-size: 14px; color: #333;">Enable daily backup</span>
</label>

<label style="display: flex; align-items: center; background: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 10px 12px; cursor: pointer; margin-bottom: 10px;">
  <input type="checkbox" style="margin-right: 10px; width: 16px; height: 16px; accent-color: #2c7be5;" />
  <span style="font-size: 14px; color: #333;">Enable notifications and analysis</span>
</label>

<label style="display: flex; align-items: center; background: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 10px 12px; cursor: pointer; margin-bottom: 10px;">
  <input type="checkbox" style="margin-right: 10px; width: 16px; height: 16px; accent-color: #2c7be5;" />
  <span style="font-size: 14px; color: #333;">Disable bot before reaching rate limit</span>
</label>



      <div style="background-color: #e0f2ff; border-left: 4px solid #2196f3; padding: 16px; border-radius: 8px; color: #0b3d91; margin-bottom: 16px; font-family: sans-serif; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
  <div style="font-weight: 600; font-size: 15px; margin-bottom: 4px;">
    You're creating an AI agent. This is a final confirmation.
  </div>
  <div style="font-size: 13px;">
    Once you proceed, your AI agent will be created and ready to use. You can easily edit its settings, behavior, and responses anytime from your account dashboard. There are absolutely no additional charges for making changes later, and you retain full control over how it functions. Take your time to review everything ‚Äî and feel free to make adjustments in the future to suit your needs. We‚Äôre here to help you build something amazing!
  </div>
</div>


    </div>

  </div>

</div>

                        </div>
                    </div>
                    <div class="sidebar-panel">
                        <div class="sidebar-title">Deploy and Launch</div>
                        <div class="size-info" style="display: block;">
                          <li>Plese confirm all the checkpoints</li>
                          <li>Once you hit create agent your agent will be deployed automatically</li>
                          <li>You can customise all the information at any time from edit section</li>
                        </div>
                        <button class="create-btn" onclick="window.location.href='{% url 'mainapp:agents' %}'">Create agent</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Opening Pop Up  -->
<!-- THEME SELECTION COMPONENT -->
<div id="themePopup" style="
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.4);
  z-index: 9999;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(8px);
">

  <div style="
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 24px;
    max-width: 1600px;
    width: 95%;
    height: 90vh;
    overflow-y: auto;
    padding: 40px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.12), 0 8px 25px rgba(0,0,0,0.08);
    position: relative;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    animation: slideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: 1px solid rgba(255, 255, 255, 0.3);
  ">

    <!-- Close button -->
    <button onclick="closeThemePopup()" style="
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.8);
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      color: #6b7280;
      transition: all 0.2s ease;
      backdrop-filter: blur(10px);
    " onmouseover="this.style.background='rgba(239, 68, 68, 0.1)'; this.style.color='#ef4444'" onmouseout="this.style.background='rgba(255, 255, 255, 0.8)'; this.style.color='#6b7280'">‚úñ</button>

    <!-- Header -->
    <div style="text-align: center; margin-bottom: 30px;">
      <h2 style="font-size: 28px; margin-bottom: 8px; color: #1f2937; font-weight: 700;"> Select a Theme</h2>
    </div>

    <!-- Tab Buttons -->
    <div style="display: flex; justify-content: center; gap: 16px; margin-bottom: 32px; flex-wrap: wrap;">
      <button class="theme-tab active-tab" onclick="showThemeTab(event, 'basic')">Basic</button>
      <button class="theme-tab" onclick="showThemeTab(event, 'modern')">Modern</button>
      <button class="theme-tab" onclick="showThemeTab(event, 'dark')">Dark</button>
    </div>

    <!-- Themes -->
    <div id="tab-basic" class="theme-tab-group" style="display: flex; flex-wrap: wrap; gap: 28px; justify-content: center;">
      <!-- Theme 1 -->
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
      <div onclick="selectTheme('NVB Theme')" class="theme-card">
        <img src="https://www.designbolts.com/wp-content/uploads/2021/05/Free-Website-Presentation-Mockup-PSD-833x625.jpg" alt="NVB Theme">
        <div class="theme-info">
          <h3>NVB Theme</h3>
          <p>Clean & Professional</p>
        </div>
      </div>
    </div>

    <div id="tab-modern" class="theme-tab-group" style="display: none; flex-wrap: wrap; gap: 28px; justify-content: center;">
      <!-- Theme 2 -->
      <div onclick="selectTheme('Modern Lite')" class="theme-card">
        <img src="https://via.placeholder.com/300x160?text=Modern+Theme" alt="Modern Lite">
        <div class="theme-info">
          <h3>Modern Lite</h3>
          <p>Minimal & Smooth</p>
        </div>
      </div>
    </div>

    <div id="tab-dark" class="theme-tab-group" style="display: none; flex-wrap: wrap; gap: 28px; justify-content: center;">
      <!-- Theme 3 -->
      <div onclick="selectTheme('Dark Modern')" class="theme-card">
        <img src="https://cdn.dribbble.com/users/1322566/screenshots/17572054/media/2eb631cd2fa734558cad7ad9aa05a566.jpg" alt="Dark Modern">
        <div class="theme-info">
          <h3>Dark Modern</h3>
          <p>Sleek & Night-ready</p>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Styles -->
<style>
@keyframes slideIn {
  from { opacity: 0; transform: translateY(-30px) scale(0.95); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
.theme-tab {
  background: #f3f4f6;
  border: 1px solid #d1d5db;
  font-size: 15px;
  padding: 10px 20px;
  cursor: pointer;
  border-radius: 8px;
  font-weight: 500;
  transition: all 0.2s ease;
}
.theme-tab:hover {
  background: #e5e7eb;
}
.theme-card {
  width: 300px;
  cursor: pointer;
  border: 1px solid rgba(229, 231, 235, 0.6);
  border-radius: 16px;
  overflow: hidden;
  transition: all 0.3s ease;
  background: rgba(255,255,255,0.7);
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}
.theme-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.15);
  border-color: rgba(99, 102, 241, 0.3);
}
.theme-card img {
  width: 100%;
  height: 160px;
  object-fit: cover;
}
.theme-info {
  padding: 20px;
  text-align: center;
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(10px);
}
.theme-info h3 {
  margin: 0 0 4px 0;
  font-weight: 600;
  font-size: 18px;
  color: #1f2937;
}
.theme-info p {
  margin: 0;
  color: #6b7280;
  font-size: 14px;
}
</style>

<!-- Scripts -->
<script>
function openThemePopup() {
  document.getElementById("themePopup").style.display = "flex";
}

function closeThemePopup() {
  document.getElementById("themePopup").style.display = "none";
}

function selectTheme(themeName) {
  alert("‚úÖ Theme selected: " + themeName);
  closeThemePopup();
}

function showThemeTab(e, tab) {
  const groups = document.querySelectorAll('.theme-tab-group');
  groups.forEach(g => g.style.display = 'none');

  const tabs = document.querySelectorAll('.theme-tab');
  tabs.forEach(t => t.classList.remove('active-tab'));

  document.getElementById('tab-' + tab).style.display = 'flex';
  e.target.classList.add('active-tab');
}
</script>


    <!-- Opening Pop Up End  -->
    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            event.target.closest('.tab').classList.add('active');
        }

        function toggleFormat(format) {
            const textarea = document.getElementById('text');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            if (selectedText) {
                let formattedText = selectedText;
                switch(format) {
                    case 'bold':
                        formattedText = `**${selectedText}**`;
                        break;
                    case 'italic':
                        formattedText = `*${selectedText}*`;
                        break;
                    case 'underline':
                        formattedText = `__${selectedText}__`;
                        break;
                }
                
                textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
                textarea.focus();
                textarea.setSelectionRange(start + formattedText.length, start + formattedText.length);
                updateByteCounter();
            }
        }

        function insertList(type) {
            const textarea = document.getElementById('text');
            const start = textarea.selectionStart;
            const listItem = type === 'ul' ? '‚Ä¢ ' : '1. ';
            
            textarea.value = textarea.value.substring(0, start) + listItem + textarea.value.substring(start);
            textarea.focus();
            textarea.setSelectionRange(start + listItem.length, start + listItem.length);
            updateByteCounter();
        }

        function insertLink() {
            const textarea = document.getElementById('text');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            const linkText = selectedText || 'link text';
            const linkFormat = `[${linkText}](url)`;
            
            textarea.value = textarea.value.substring(0, start) + linkFormat + textarea.value.substring(end);
            textarea.focus();
            textarea.setSelectionRange(start + linkFormat.length, start + linkFormat.length);
            updateByteCounter();
        }

        function updateByteCounter() {
            const textarea = document.getElementById('text');
            const byteCounter = document.getElementById('byteCounter');
            const bytes = new Blob([textarea.value]).size;
            
            if (bytes < 1024) {
                byteCounter.textContent = `${bytes} B`;
            } else {
                byteCounter.textContent = `${(bytes / 1024).toFixed(1)} KB`;
            }
        }
    </script>
    <style>
.tabs {
  color: rgb(199, 199, 199) !important;
  border: none !important;
  border-bottom: 2px solid rgb(241, 241, 241) !important;
  background: none !important;
  outline: none !important;
  box-shadow: none !important;
}

.tabs:focus,
.tabs:active,
.tabs:visited,
.tabs:hover {
  color: rgb(186, 186, 186) !important;
  border: none !important;
  border-bottom: 2px solid rgb(228, 228, 228) !important;
  background: none !important;
  outline: none !important;
  box-shadow: none !important;
}

@media (max-width: 800px) {
   .tabs {
       overflow-x: auto;
       flex-wrap: nowrap;
       scrollbar-width: none;
       -ms-overflow-style: none;
   }
   
   .tabs::-webkit-scrollbar {
       display: none;
   }
   
   .tab {
       flex-shrink: 0;
       min-width: 120px;
   }
   
   .main-content {
       flex-direction: column;
       gap: 20px;
   }
   
   .sidebar-panel {
       width: 100%;
       order: 2;
   }
   
   .content-area {
       order: 1;
   }
}

@media (max-width: 600px) {
   .container {
       padding: 20px 15px;
   }
   
   .header {
       padding: 30px 20px;
       margin-bottom: 30px;
   }
   
   .header h1 {
       font-size: 2rem;
   }
   
   .header p {
       font-size: 1rem;
   }
   
   .tab {
       min-width: 100px;
       padding: 12px 16px;
       font-size: 0.9rem;
   }
   
   .content-area {
       padding: 24px 20px;
   }
   
   .sidebar-panel {
       padding: 20px;
   }
}

@media (max-width: 500px) {
   .container {
       padding: 15px 10px;
   }
   
   .header h1 {
       font-size: 1.8rem;
   }
   
   .tab {
       min-width: 90px;
       padding: 10px 12px;
       font-size: 0.85rem;
   }
   
   .tab-icon {
       font-size: 1rem;
   }
   
   .content-area {
       padding: 20px 15px;
   }
   
   .sidebar-panel {
       padding: 18px;
   }
   
   .content-title {
       font-size: 1.3rem;
   }
}

@media (max-width: 400px) {
   .header h1 {
       font-size: 1.6rem;
   }
   
   .tab {
       min-width: 80px;
       padding: 8px 10px;
       font-size: 0.8rem;
       gap: 6px;
   }
   
   .tab-icon {
       font-size: 0.9rem;
   }
   
   .content-area {
       padding: 16px 12px;
   }
   
   .sidebar-panel {
       padding: 16px;
   }
   
   .form-input {
       padding: 10px 12px;
   }
   
   .editor-textarea {
       padding: 12px;
   }
   
   .content-title {
       font-size: 1.2rem;
   }
}
@media (min-width: 1001px) {
  .content-area {
    margin-left: -27%;
  }
}

</style>

<script>
  const dropBox = document.getElementById('dropBox');
  const fileInput = document.getElementById('fileUpload');

  // Highlight when clicked
  dropBox.addEventListener('click', () => {
    dropBox.style.borderColor = '#6e8efb';
    dropBox.style.backgroundColor = '#eef1ff';
  });

  // Remove highlight after file is selected
  fileInput.addEventListener('change', () => {
    dropBox.style.borderColor = '#ccc';
    dropBox.style.backgroundColor = '#fafafa';
  });
</script>
<script>
  function switchTab(tab) {
    const crawlTab = document.getElementById('crawlTab');
    const settingsTab = document.getElementById('settingsTab');
    const crawlContent = document.getElementById('crawlContent');
    const settingsContent = document.getElementById('settingsContent');

    if (tab === 'settings') {
      settingsTab.style.borderBottom = '2px solid #1a1a1a';
      settingsTab.style.color = '#1a1a1a';
      crawlTab.style.borderBottom = 'none';
      crawlTab.style.color = '#666';
      crawlContent.style.display = 'none';
      settingsContent.style.display = 'block';
    } else {
      crawlTab.style.borderBottom = '2px solid #1a1a1a';
      crawlTab.style.color = '#1a1a1a';
      settingsTab.style.borderBottom = 'none';
      settingsTab.style.color = '#666';
      crawlContent.style.display = 'block';
      settingsContent.style.display = 'none';
    }
  }

  function validateAndTrain() {
    const input = document.getElementById("urlInput");
    const error = document.getElementById("urlError");
    const value = input.value.trim();
    const pattern = /^([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/\S*)?$/;

    if (pattern.test(value)) {
      error.style.display = "none";
      alert("‚úÖ Crawling started for: https://" + value);
    } else {
      error.style.display = "block";
    }
  }

  function toggleOption(btn) {
    const isSelected = btn.classList.contains("selected");
    if (isSelected) {
      btn.classList.remove("selected");
      btn.style.background = "#f1f1f1";
      btn.style.color = "#333";
      btn.style.borderColor = "#ccc";
    } else {
      btn.classList.add("selected");
      btn.style.background = "#3b82f6";
      btn.style.color = "#fff";
      btn.style.borderColor = "#3b82f6";
    }
  }
</script>

<style>
  .option-btn {
    padding: 10px 16px;
    background: #f1f1f1;
    color: #333;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s ease;
  }

  .option-btn:hover {
    background: #e5e5e5;
  }

  .option-btn.selected {
    background: #3b82f6 !important;
    color: #fff !important;
    border-color: #3b82f6 !important;
  }
</style>


<!-- Form Submission Ajax --------------------------------------------------------------------------------------------->
<script>
document.getElementById('botForm').addEventListener('submit', function (e) {
  e.preventDefault();
  const form = e.target;
  const formData = new FormData(form);

  fetch(form.action, {
    method: 'POST',
    body: formData,
    headers: {
      'X-CSRFToken': formData.get('csrfmiddlewaretoken')
    }
  })
  .then(response => {
    console.log("Raw response:", response);
    return response.json(); // attempt to parse as JSON
  })
  .then(data => {
    console.log("Parsed JSON:", data);
    if (data.success) {
      alert("‚úÖ Bot created successfully with ID: " + data.bot_id);
      // Save bot ID for next step (file upload)
      localStorage.setItem('last_created_bot_id', data.bot_id);
      form.reset();
      // Switch to "Files" tab
      document.querySelector('.tab[onclick="showTab(\'files\')"]').click();
    } else {
      alert("‚ùå Error creating bot: " + (data.error || 'Unknown error'));
    }
  })
  .catch(err => {
    console.error("Fetch error:", err);
    alert("‚ùå Something went wrong. Check console.");
  });
});
</script>



{% endblock content %}